name: Deploy Development Environment
on:
  push:
    branches: [ master ]
    
jobs:
  Non-Prod:
    runs-on: hosted-runner
    environment: Development
    steps:
    - name: Checkout source code
      uses: actions/checkout@v3
      with:
        token: ${{ secrets.GH_TOKEN }}
        submodules: true

    - name: Deploy
      uses: ./.github/actions/deploy.yml
      with:
        environment: Development
        account_id: ${{ env.aws_account_id}}
        account_name: awsaccountnp
        artifact_name: np-s3-eb-deployment
        region: ca-central-1


  Production:
    runs-on: hosted-runner
    environment: Production
    steps:
    - name: Checkout source code
      uses: actions/checkout@v3
      with:
        token: ${{ secrets.GH_TOKEN }}
        submodules: true

    - name: Deploy
      uses: ./.github/actions/deploy.yml
      with:
        environment: Production
        account_id: ${{ env.aws_account_id}}
        account_name: awsaccountprod
        artifact_name: prod-s3-eb-deployment
        region: ca-central-1
    